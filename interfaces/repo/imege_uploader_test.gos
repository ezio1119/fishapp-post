package repo

import (
	"context"
	"os"
	"testing"

	"github.com/ezio1119/fishapp-post/infrastructure"
	"github.com/google/uuid"
)

func TestUploadImage(t *testing.T) {
	ctx := context.Background()

	client, err := infrastructure.NewGCSClient(ctx)
	if err != nil {
		t.Fatal(err)
	}
	defer client.Close()

	repo := NewImageUploaderRepo(client)
	file, err := os.Open("/app/images/724-2.jpg")
	if err != nil {
		t.Fatal(err)
	}
	if err := repo.UploadImage(ctx, file, uuid.New().String()); err != nil {
		t.Fatal(err)
	}
}
